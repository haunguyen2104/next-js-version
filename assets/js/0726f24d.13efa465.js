"use strict";(self.webpackChunknext_version=self.webpackChunknext_version||[]).push([[5542],{9907:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>l});var s=t(5893),o=t(1151);const r={description:"Next.js' Fast Refresh is a new hot reloading experience that gives you instantaneous feedback on edits made to your React components."},i="Fast Refresh",a={id:"next-js/v13.0.0/basic-features/fast-refresh",title:"Fast Refresh",description:"Next.js' Fast Refresh is a new hot reloading experience that gives you instantaneous feedback on edits made to your React components.",source:"@site/docs/next-js/v13.0.0/basic-features/fast-refresh.md",sourceDirName:"next-js/v13.0.0/basic-features",slug:"/next-js/v13.0.0/basic-features/fast-refresh",permalink:"/next-js/v13.0.0/basic-features/fast-refresh",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/next-js/v13.0.0/basic-features/fast-refresh.md",tags:[],version:"current",frontMatter:{description:"Next.js' Fast Refresh is a new hot reloading experience that gives you instantaneous feedback on edits made to your React components."},sidebar:"tutorialSidebar",previous:{title:"ESLint",permalink:"/next-js/v13.0.0/basic-features/eslint"},next:{title:"Font Optimization",permalink:"/next-js/v13.0.0/basic-features/font-optimization"}},d={},l=[{value:"How It Works",id:"how-it-works",level:2},{value:"Error Resilience",id:"error-resilience",level:2},{value:"Syntax Errors",id:"syntax-errors",level:3},{value:"Runtime Errors",id:"runtime-errors",level:3},{value:"Limitations",id:"limitations",level:2},{value:"Tips",id:"tips",level:2},{value:"Fast Refresh and Hooks",id:"fast-refresh-and-hooks",level:2}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.a)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"fast-refresh",children:"Fast Refresh"}),"\n",(0,s.jsxs)(t,{open:!0,children:[(0,s.jsx)("summary",{children:(0,s.jsx)("b",{children:"Examples"})}),(0,s.jsx)("ul",{children:(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"https://github.com/vercel/next.js/tree/canary/examples/fast-refresh-demo",children:"Fast Refresh Demo"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["Fast Refresh is a Next.js feature that gives you instantaneous feedback on\nedits made to your React components. Fast Refresh is enabled by default in all\nNext.js applications on ",(0,s.jsx)(n.strong,{children:"9.4 or newer"}),". With Next.js Fast Refresh enabled,\nmost edits should be visible within a second, ",(0,s.jsx)(n.strong,{children:"without losing component\nstate"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["If you edit a file that ",(0,s.jsx)(n.strong,{children:"only exports React component(s)"}),", Fast Refresh will\nupdate the code only for that file, and re-render your component. You can edit\nanything in that file, including styles, rendering logic, event handlers, or\neffects."]}),"\n",(0,s.jsxs)(n.li,{children:["If you edit a file with exports that ",(0,s.jsx)(n.em,{children:"aren't"})," React components, Fast Refresh\nwill re-run both that file, and the other files importing it. So if both\n",(0,s.jsx)(n.code,{children:"Button.js"})," and ",(0,s.jsx)(n.code,{children:"Modal.js"})," import ",(0,s.jsx)(n.code,{children:"theme.js"}),", editing ",(0,s.jsx)(n.code,{children:"theme.js"})," will update\nboth components."]}),"\n",(0,s.jsxs)(n.li,{children:["Finally, if you ",(0,s.jsx)(n.strong,{children:"edit a file"})," that's ",(0,s.jsx)(n.strong,{children:"imported by files outside of the\nReact tree"}),", Fast Refresh ",(0,s.jsx)(n.strong,{children:"will fall back to doing a full reload"}),". You\nmight have a file which renders a React component but also exports a value\nthat is imported by a ",(0,s.jsx)(n.strong,{children:"non-React component"}),". For example, maybe your\ncomponent also exports a constant, and a non-React utility file imports it. In\nthat case, consider migrating the constant to a separate file and importing it\ninto both files. This will re-enable Fast Refresh to work. Other cases can\nusually be solved in a similar way."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"error-resilience",children:"Error Resilience"}),"\n",(0,s.jsx)(n.h3,{id:"syntax-errors",children:"Syntax Errors"}),"\n",(0,s.jsxs)(n.p,{children:["If you make a syntax error during development, you can fix it and save the file\nagain. The error will disappear automatically, so you won't need to reload the\napp. ",(0,s.jsx)(n.strong,{children:"You will not lose component state"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"runtime-errors",children:"Runtime Errors"}),"\n",(0,s.jsx)(n.p,{children:"If you make a mistake that leads to a runtime error inside your component,\nyou'll be greeted with a contextual overlay. Fixing the error will automatically\ndismiss the overlay, without reloading the app."}),"\n",(0,s.jsx)(n.p,{children:"Component state will be retained if the error did not occur during rendering. If\nthe error did occur during rendering, React will remount your application using\nthe updated code."}),"\n",(0,s.jsxs)(n.p,{children:["If you have ",(0,s.jsx)(n.a,{href:"https://reactjs.org/docs/error-boundaries.html",children:"error boundaries"}),"\nin your app (which is a good idea for graceful failures in production), they\nwill retry rendering on the next edit after a rendering error. This means having\nan error boundary can prevent you from always getting reset to the root app\nstate. However, keep in mind that error boundaries shouldn't be ",(0,s.jsx)(n.em,{children:"too"})," granular.\nThey are used by React in production, and should always be designed\nintentionally."]}),"\n",(0,s.jsx)(n.h2,{id:"limitations",children:"Limitations"}),"\n",(0,s.jsx)(n.p,{children:"Fast Refresh tries to preserve local React state in the component you're\nediting, but only if it's safe to do so. Here's a few reasons why you might see\nlocal state being reset on every edit to a file:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Local state is not preserved for class components (only function components\nand Hooks preserve state)."}),"\n",(0,s.jsxs)(n.li,{children:["The file you're editing might have ",(0,s.jsx)(n.em,{children:"other"})," exports in addition to a React\ncomponent."]}),"\n",(0,s.jsxs)(n.li,{children:["Sometimes, a file would export the result of calling a higher-order component\nlike ",(0,s.jsx)(n.code,{children:"HOC(WrappedComponent)"}),". If the returned component is a\nclass, its state will be reset."]}),"\n",(0,s.jsxs)(n.li,{children:["Anonymous arrow functions like ",(0,s.jsx)(n.code,{children:"export default () => <div />;"})," cause Fast Refresh to not preserve local component state. For large codebases you can use our ",(0,s.jsxs)(n.a,{href:"/docs/advanced-features/codemods.md#name-default-component",children:[(0,s.jsx)(n.code,{children:"name-default-component"})," codemod"]}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"As more of your codebase moves to function components and Hooks, you can expect\nstate to be preserved in more cases."}),"\n",(0,s.jsx)(n.h2,{id:"tips",children:"Tips"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Fast Refresh preserves React local state in function components (and Hooks) by\ndefault."}),"\n",(0,s.jsxs)(n.li,{children:["Sometimes you might want to ",(0,s.jsx)(n.em,{children:"force"})," the state to be reset, and a component to\nbe remounted. For example, this can be handy if you're tweaking an animation\nthat only happens on mount. To do this, you can add ",(0,s.jsx)(n.code,{children:"// @refresh reset"}),"\nanywhere in the file you're editing. This directive is local to the file, and\ninstructs Fast Refresh to remount components defined in that file on every\nedit."]}),"\n",(0,s.jsxs)(n.li,{children:["You can put ",(0,s.jsx)(n.code,{children:"console.log"})," or ",(0,s.jsx)(n.code,{children:"debugger;"})," into the components you edit during\ndevelopment."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"fast-refresh-and-hooks",children:"Fast Refresh and Hooks"}),"\n",(0,s.jsxs)(n.p,{children:["When possible, Fast Refresh attempts to preserve the state of your component\nbetween edits. In particular, ",(0,s.jsx)(n.code,{children:"useState"})," and ",(0,s.jsx)(n.code,{children:"useRef"})," preserve their previous\nvalues as long as you don't change their arguments or the order of the Hook\ncalls."]}),"\n",(0,s.jsxs)(n.p,{children:["Hooks with dependencies\u2014such as ",(0,s.jsx)(n.code,{children:"useEffect"}),", ",(0,s.jsx)(n.code,{children:"useMemo"}),", and ",(0,s.jsx)(n.code,{children:"useCallback"}),"\u2014will\n",(0,s.jsx)(n.em,{children:"always"})," update during Fast Refresh. Their list of dependencies will be ignored\nwhile Fast Refresh is happening."]}),"\n",(0,s.jsxs)(n.p,{children:["For example, when you edit ",(0,s.jsx)(n.code,{children:"useMemo(() => x * 2, [x])"})," to\n",(0,s.jsx)(n.code,{children:"useMemo(() => x * 10, [x])"}),", it will re-run even though ",(0,s.jsx)(n.code,{children:"x"})," (the dependency)\nhas not changed. If React didn't do that, your edit wouldn't reflect on the\nscreen!"]}),"\n",(0,s.jsxs)(n.p,{children:["Sometimes, this can lead to unexpected results. For example, even a ",(0,s.jsx)(n.code,{children:"useEffect"}),"\nwith an empty array of dependencies would still re-run once during Fast Refresh."]}),"\n",(0,s.jsxs)(n.p,{children:["However, writing code resilient to occasional re-running of ",(0,s.jsx)(n.code,{children:"useEffect"})," is a good practice even\nwithout Fast Refresh. It will make it easier for you to introduce new dependencies to it later on\nand it's enforced by ",(0,s.jsx)(n.a,{href:"/docs/api-reference/next.config.js/react-strict-mode.md",children:"React Strict Mode"}),",\nwhich we highly recommend enabling."]})]})}function h(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>i});var s=t(7294);const o={},r=s.createContext(o);function i(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);