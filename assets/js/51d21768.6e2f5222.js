"use strict";(self.webpackChunknext_version=self.webpackChunknext_version||[]).push([[7899],{3821:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var t=n(5893),r=n(1151);const o={description:"API Routes include a set of Express.js-like methods for the response to help you creating new API endpoints. Learn how it works here."},a="API Routes Response Helpers",i={id:"next-js/v13.0.0/api-routes/response-helpers",title:"API Routes Response Helpers",description:"API Routes include a set of Express.js-like methods for the response to help you creating new API endpoints. Learn how it works here.",source:"@site/docs/next-js/v13.0.0/api-routes/response-helpers.md",sourceDirName:"next-js/v13.0.0/api-routes",slug:"/next-js/v13.0.0/api-routes/response-helpers",permalink:"/next-js/v13.0.0/api-routes/response-helpers",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/next-js/v13.0.0/api-routes/response-helpers.md",tags:[],version:"current",frontMatter:{description:"API Routes include a set of Express.js-like methods for the response to help you creating new API endpoints. Learn how it works here."},sidebar:"tutorialSidebar",previous:{title:"API Routes Request Helpers",permalink:"/next-js/v13.0.0/api-routes/request-helpers"},next:{title:"Authentication",permalink:"/next-js/v13.0.0/authentication"}},d={},c=[{value:"Setting the status code of a response",id:"setting-the-status-code-of-a-response",level:2},{value:"Sending a JSON response",id:"sending-a-json-response",level:2},{value:"Sending a HTTP response",id:"sending-a-http-response",level:2},{value:"Redirects to a specified path or URL",id:"redirects-to-a-specified-path-or-url",level:2},{value:"Adding TypeScript types",id:"adding-typescript-types",level:2}];function l(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{id:"api-routes-response-helpers",children:"API Routes Response Helpers"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.a,{href:"https://nodejs.org/api/http.html#http_class_http_serverresponse",children:"Server Response object"}),", (often abbreviated as ",(0,t.jsx)(s.code,{children:"res"}),") includes a set of Express.js-like helper methods to improve the developer experience and increase the speed of creating new API endpoints."]}),"\n",(0,t.jsx)(s.p,{children:"The included helpers are:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"res.status(code)"})," - A function to set the status code. ",(0,t.jsx)(s.code,{children:"code"})," must be a valid ",(0,t.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/List_of_HTTP_status_codes",children:"HTTP status code"})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"res.json(body)"})," - Sends a JSON response. ",(0,t.jsx)(s.code,{children:"body"})," must be a ",(0,t.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Glossary/Serialization",children:"serializable object"})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"res.send(body)"})," - Sends the HTTP response. ",(0,t.jsx)(s.code,{children:"body"})," can be a ",(0,t.jsx)(s.code,{children:"string"}),", an ",(0,t.jsx)(s.code,{children:"object"})," or a ",(0,t.jsx)(s.code,{children:"Buffer"})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"res.redirect([status,] path)"})," - Redirects to a specified path or URL. ",(0,t.jsx)(s.code,{children:"status"})," must be a valid ",(0,t.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/List_of_HTTP_status_codes",children:"HTTP status code"}),". If not specified, ",(0,t.jsx)(s.code,{children:"status"}),' defaults to "307" "Temporary redirect".']}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"res.revalidate(urlPath)"})," - ",(0,t.jsx)(s.a,{href:"/docs/basic-features/data-fetching/incremental-static-regeneration.md#on-demand-revalidation",children:"Revalidate a page on demand"})," using ",(0,t.jsx)(s.code,{children:"getStaticProps"}),". ",(0,t.jsx)(s.code,{children:"urlPath"})," must be a ",(0,t.jsx)(s.code,{children:"string"}),"."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"setting-the-status-code-of-a-response",children:"Setting the status code of a response"}),"\n",(0,t.jsx)(s.p,{children:"When sending a response back to the client, you can set the status code of the response."}),"\n",(0,t.jsxs)(s.p,{children:["The following example sets the status code of the response to ",(0,t.jsx)(s.code,{children:"200"})," (",(0,t.jsx)(s.code,{children:"OK"}),") and returns a ",(0,t.jsx)(s.code,{children:"message"})," property with the value of ",(0,t.jsx)(s.code,{children:"Hello from Next.js!"})," as a JSON response:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"export default function handler(req, res) {\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}\n"})}),"\n",(0,t.jsx)(s.h2,{id:"sending-a-json-response",children:"Sending a JSON response"}),"\n",(0,t.jsxs)(s.p,{children:["When sending a response back to the client you can send a JSON response, this must be a ",(0,t.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Glossary/Serialization",children:"serializable object"}),".\nIn a real world application you might want to let the client know the status of the request depending on the result of the requested endpoint."]}),"\n",(0,t.jsxs)(s.p,{children:["The following example sends a JSON response with the status code ",(0,t.jsx)(s.code,{children:"200"})," (",(0,t.jsx)(s.code,{children:"OK"}),") and the result of the async operation. It's contained in a try catch block to handle any errors that may occur, with the appropriate status code and error message caught and sent back to the client:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"export default async function handler(req, res) {\n  try {\n    const result = await someAsyncOperation()\n    res.status(200).json({ result })\n  } catch (err) {\n    res.status(500).json({ error: 'failed to load data' })\n  }\n}\n"})}),"\n",(0,t.jsx)(s.h2,{id:"sending-a-http-response",children:"Sending a HTTP response"}),"\n",(0,t.jsxs)(s.p,{children:["Sending an HTTP response works the same way as when sending a JSON response. The only difference is that the response body can be a ",(0,t.jsx)(s.code,{children:"string"}),", an ",(0,t.jsx)(s.code,{children:"object"})," or a ",(0,t.jsx)(s.code,{children:"Buffer"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["The following example sends a HTTP response with the status code ",(0,t.jsx)(s.code,{children:"200"})," (",(0,t.jsx)(s.code,{children:"OK"}),") and the result of the async operation."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"export default async function handler(req, res) {\n  try {\n    const result = await someAsyncOperation()\n    res.status(200).send({ result })\n  } catch (err) {\n    res.status(500).send({ error: 'failed to fetch data' })\n  }\n}\n"})}),"\n",(0,t.jsx)(s.h2,{id:"redirects-to-a-specified-path-or-url",children:"Redirects to a specified path or URL"}),"\n",(0,t.jsx)(s.p,{children:"Taking a form as an example, you may want to redirect your client to a specified path or URL once they have submitted the form."}),"\n",(0,t.jsxs)(s.p,{children:["The following example redirects the client to the ",(0,t.jsx)(s.code,{children:"/"})," path if the form is successfully submitted:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"export default async function handler(req, res) {\n  const { name, message } = req.body\n  try {\n    await handleFormInputAsync({ name, message })\n    res.redirect(307, '/')\n  } catch (err) {\n    res.status(500).send({ error: 'failed to fetch data' })\n  }\n}\n"})}),"\n",(0,t.jsx)(s.h2,{id:"adding-typescript-types",children:"Adding TypeScript types"}),"\n",(0,t.jsxs)(s.p,{children:["You can make your response handlers more type-safe by importing the ",(0,t.jsx)(s.code,{children:"NextApiRequest"})," and ",(0,t.jsx)(s.code,{children:"NextApiResponse"})," types from ",(0,t.jsx)(s.code,{children:"next"}),", in addition to those, you can also type your response data:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-ts",children:"import type { NextApiRequest, NextApiResponse } from 'next'\n\ntype ResponseData = {\n  message: string\n}\n\nexport default function handler(\n  req: NextApiRequest,\n  res: NextApiResponse<ResponseData>\n) {\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}\n"})}),"\n",(0,t.jsxs)(s.p,{children:["To view more examples using types, check out the ",(0,t.jsx)(s.a,{href:"/docs/basic-features/typescript.md#api-routes",children:"TypeScript documentation"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"If you prefer to view your examples within a real projects structure you can checkout our examples repository:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://github.com/vercel/next.js/tree/canary/examples/api-routes",children:"Basic API Routes"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://github.com/vercel/next.js/tree/canary/examples/api-routes-rest",children:"API Routes with REST"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,r.a)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},1151:(e,s,n)=>{n.d(s,{Z:()=>i,a:()=>a});var t=n(7294);const r={},o=t.createContext(r);function a(e){const s=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(o.Provider,{value:s},e.children)}}}]);