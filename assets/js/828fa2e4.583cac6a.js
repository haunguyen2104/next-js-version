"use strict";(self.webpackChunknext_version=self.webpackChunknext_version||[]).push([[505],{6810:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>o});var r=t(5893),s=t(1151);const i={description:"Learn more about the switchable runtimes (Edge and Node.js) in Next.js."},d="Edge and Node.js Runtimes",a={id:"next-js/v13.0.1/advanced-features/react-18/switchable-runtime",title:"Edge and Node.js Runtimes",description:"Learn more about the switchable runtimes (Edge and Node.js) in Next.js.",source:"@site/docs/next-js/v13.0.1/advanced-features/react-18/switchable-runtime.md",sourceDirName:"next-js/v13.0.1/advanced-features/react-18",slug:"/next-js/v13.0.1/advanced-features/react-18/switchable-runtime",permalink:"/next-js/v13.0.1/advanced-features/react-18/switchable-runtime",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/next-js/v13.0.1/advanced-features/react-18/switchable-runtime.md",tags:[],version:"current",frontMatter:{description:"Learn more about the switchable runtimes (Edge and Node.js) in Next.js."},sidebar:"tutorialSidebar",previous:{title:"Streaming SSR",permalink:"/next-js/v13.0.1/advanced-features/react-18/streaming"},next:{title:"Security Headers",permalink:"/next-js/v13.0.1/advanced-features/security-headers"}},c={},o=[{value:"Global Runtime Option",id:"global-runtime-option",level:2},{value:"Page Runtime Option",id:"page-runtime-option",level:2},{value:"Runtime Differences",id:"runtime-differences",level:2},{value:"Edge API Routes",id:"edge-api-routes",level:2},{value:"Related",id:"related",level:2}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"edge-and-nodejs-runtimes",children:"Edge and Node.js Runtimes"}),"\n",(0,r.jsxs)(n.p,{children:["Next.js has two ",(0,r.jsx)(n.strong,{children:"server runtimes"})," where you can render parts of your application code: the ",(0,r.jsx)(n.strong,{children:"Node.js Runtime"})," and the ",(0,r.jsx)(n.a,{href:"/docs/api-reference/edge-runtime.md",children:(0,r.jsx)(n.strong,{children:"Edge Runtime"})}),". Depending on your deployment infrastructure, both runtimes support streaming."]}),"\n",(0,r.jsxs)(n.p,{children:["By default, Next.js uses the Node.js runtime. ",(0,r.jsx)(n.a,{href:"https://nextjs.org/docs/advanced-features/middleware",children:"Middleware"})," and ",(0,r.jsx)(n.a,{href:"https://nextjs.org/docs/api-routes/edge-api-routes",children:"Edge API Routes"})," use the Edge runtime."]}),"\n",(0,r.jsx)(n.h2,{id:"global-runtime-option",children:"Global Runtime Option"}),"\n",(0,r.jsxs)(n.p,{children:["To configure the runtime for your whole application, you can set the experimental option ",(0,r.jsx)(n.code,{children:"runtime"})," in your ",(0,r.jsx)(n.code,{children:"next.config.js"})," file:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// next.config.js\nmodule.exports = {\n  experimental: {\n    runtime: 'experimental-edge', // 'node.js' (default) | experimental-edge\n  },\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["You can detect which runtime you're using by looking at the ",(0,r.jsx)(n.code,{children:"process.env.NEXT_RUNTIME"})," Environment Variable during runtime, and examining the ",(0,r.jsx)(n.code,{children:"options.nextRuntime"})," variable during compilation."]}),"\n",(0,r.jsx)(n.h2,{id:"page-runtime-option",children:"Page Runtime Option"}),"\n",(0,r.jsxs)(n.p,{children:["On each page, you can optionally export a ",(0,r.jsx)(n.code,{children:"runtime"})," config set to either ",(0,r.jsx)(n.code,{children:"'nodejs'"})," or ",(0,r.jsx)(n.code,{children:"'experimental-edge'"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",children:"// pages/index.js\nexport default function Index () { ... }\n\nexport function getServerSideProps() { ... }\n\nexport const config = {\n  runtime: 'experimental-edge',\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["When both the per-page runtime and global runtime are set, the per-page runtime overrides the global runtime. If the per-page runtime is ",(0,r.jsx)(n.em,{children:"not"})," set, the global runtime option will be used."]}),"\n",(0,r.jsx)(n.h2,{id:"runtime-differences",children:"Runtime Differences"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\xa0"}),(0,r.jsx)(n.th,{children:"Node (Server)"}),(0,r.jsx)(n.th,{children:"Node (Serverless)"}),(0,r.jsx)(n.th,{children:"Edge"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://vercel.com/docs/concepts/get-started/compute#cold-and-hot-boots?utm_source=next-site&utm_medium=docs&utm_campaign=next-website",children:"Cold Boot"})}),(0,r.jsx)(n.td,{children:"/"}),(0,r.jsx)(n.td,{children:"~250ms"}),(0,r.jsx)(n.td,{children:"Instant"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"HTTP Streaming"}),(0,r.jsx)(n.td,{children:"Yes"}),(0,r.jsx)(n.td,{children:"Yes"}),(0,r.jsx)(n.td,{children:"Yes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"IO"}),(0,r.jsx)(n.td,{children:"All"}),(0,r.jsx)(n.td,{children:"All"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"fetch"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Scalability"}),(0,r.jsx)(n.td,{children:"/"}),(0,r.jsx)(n.td,{children:"High"}),(0,r.jsx)(n.td,{children:"Highest"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Security"}),(0,r.jsx)(n.td,{children:"Normal"}),(0,r.jsx)(n.td,{children:"High"}),(0,r.jsx)(n.td,{children:"High"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Latency"}),(0,r.jsx)(n.td,{children:"Normal"}),(0,r.jsx)(n.td,{children:"Low"}),(0,r.jsx)(n.td,{children:"Lowest"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Code Size"}),(0,r.jsx)(n.td,{children:"/"}),(0,r.jsx)(n.td,{children:"50MB"}),(0,r.jsx)(n.td,{children:"1MB"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"NPM Packages"}),(0,r.jsx)(n.td,{children:"All"}),(0,r.jsx)(n.td,{children:"All"}),(0,r.jsx)(n.td,{children:"A smaller subset"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Next.js' default runtime configuration is good for most use cases, but there\u2019re still many reasons to change to one runtime over the other one."}),"\n",(0,r.jsx)(n.p,{children:"For example, for API routes that rely on native Node.js APIs, they need to run with the Node.js Runtime. However, if an API only uses something like cookie-based authentication, using Middleware and the Edge Runtime will be a better choice due to its lower latency as well as better scalability."}),"\n",(0,r.jsx)(n.h2,{id:"edge-api-routes",children:"Edge API Routes"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"/docs/api-routes/edge-api-routes.md",children:"Edge API Routes"})," enable you to build high performance APIs with Next.js using the Edge Runtime."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"export const config = {\n  runtime: 'experimental-edge',\n}\n\nexport default (req) => new Response('Hello world!')\n"})}),"\n",(0,r.jsx)(n.h2,{id:"related",children:"Related"}),"\n",(0,r.jsx)("div",{class:"card",children:(0,r.jsxs)("a",{href:"/docs/api-reference/edge-runtime.md",children:[(0,r.jsx)("b",{children:"Edge Runtime"}),(0,r.jsx)("small",{children:"Learn more about the supported Web APIs available."})]})}),"\n",(0,r.jsx)("div",{class:"card",children:(0,r.jsxs)("a",{href:"/docs/api-reference/next/server.md",children:[(0,r.jsx)("b",{children:"Middleware API Reference"}),(0,r.jsx)("small",{children:"Learn more about the supported APIs for Middleware."})]})}),"\n",(0,r.jsx)("div",{class:"card",children:(0,r.jsxs)("a",{href:"/docs/api-routes/edge-api-routes.md",children:[(0,r.jsx)("b",{children:"Edge API Routes"}),(0,r.jsx)("small",{children:"Build high performance APIs in Next.js. "})]})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>d});var r=t(7294);const s={},i=r.createContext(s);function d(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);