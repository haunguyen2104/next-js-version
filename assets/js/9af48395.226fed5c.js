"use strict";(self.webpackChunknext_version=self.webpackChunknext_version||[]).push([[913],{5382:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>c,metadata:()=>o,toc:()=>a});var i=s(5893),t=s(1151);const c={description:"Extend the default webpack config added by Next.js."},r="Custom Webpack Config",o={id:"next-js/v13.0.1/api-reference/next.config.js/custom-webpack-config",title:"Custom Webpack Config",description:"Extend the default webpack config added by Next.js.",source:"@site/docs/next-js/v13.0.1/api-reference/next.config.js/custom-webpack-config.md",sourceDirName:"next-js/v13.0.1/api-reference/next.config.js",slug:"/next-js/v13.0.1/api-reference/next.config.js/custom-webpack-config",permalink:"/next-js/v13.0.1/api-reference/next.config.js/custom-webpack-config",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/next-js/v13.0.1/api-reference/next.config.js/custom-webpack-config.md",tags:[],version:"current",frontMatter:{description:"Extend the default webpack config added by Next.js."},sidebar:"tutorialSidebar",previous:{title:"Custom Page Extensions",permalink:"/next-js/v13.0.1/api-reference/next.config.js/custom-page-extensions"},next:{title:"Disabling ETag Generation",permalink:"/next-js/v13.0.1/api-reference/next.config.js/disabling-etag-generation"}},d={},a=[{value:"<code>nextRuntime</code>",id:"nextruntime",level:4},{value:"Related",id:"related",level:2}];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"custom-webpack-config",children:"Custom Webpack Config"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Note: changes to webpack config are not covered by semver so proceed at your own risk"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Before continuing to add custom webpack configuration to your application make sure Next.js doesn't already support your use-case:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/basic-features/built-in-css-support.md#adding-a-global-stylesheet",children:"CSS imports"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/basic-features/built-in-css-support.md#adding-component-level-css",children:"CSS modules"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/basic-features/built-in-css-support.md#sass-support",children:"Sass/SCSS imports"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/basic-features/built-in-css-support.md#sass-support",children:"Sass/SCSS modules"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/vercel/next.js/tree/canary/examples/using-preact",children:"preact"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/advanced-features/customizing-babel-config.md",children:"Customizing babel configuration"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Some commonly asked for features are available as plugins:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/vercel/next.js/tree/canary/packages/next-mdx",children:"@next/mdx"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/vercel/next.js/tree/canary/packages/next-bundle-analyzer",children:"@next/bundle-analyzer"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["In order to extend our usage of ",(0,i.jsx)(n.code,{children:"webpack"}),", you can define a function that extends its config inside ",(0,i.jsx)(n.code,{children:"next.config.js"}),", like so:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"module.exports = {\n  webpack: (\n    config,\n    { buildId, dev, isServer, defaultLoaders, nextRuntime, webpack }\n  ) => {\n    // Important: return the modified config\n    return config\n  },\n}\n"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"webpack"})," function is executed twice, once for the server and once for the client. This allows you to distinguish between client and server configuration using the ",(0,i.jsx)(n.code,{children:"isServer"})," property."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The second argument to the ",(0,i.jsx)(n.code,{children:"webpack"})," function is an object with the following properties:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"buildId"}),": ",(0,i.jsx)(n.code,{children:"String"})," - The build id, used as a unique identifier between builds"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dev"}),": ",(0,i.jsx)(n.code,{children:"Boolean"})," - Indicates if the compilation will be done in development"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"isServer"}),": ",(0,i.jsx)(n.code,{children:"Boolean"})," - It's ",(0,i.jsx)(n.code,{children:"true"})," for server-side compilation, and ",(0,i.jsx)(n.code,{children:"false"})," for client-side compilation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"nextRuntime"}),": ",(0,i.jsx)(n.code,{children:"String | undefined"})," - The target runtime for server-side compilation; either ",(0,i.jsx)(n.code,{children:'"edge"'})," or ",(0,i.jsx)(n.code,{children:'"nodejs"'}),", it's ",(0,i.jsx)(n.code,{children:"undefined"})," for client-side compilation."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"defaultLoaders"}),": ",(0,i.jsx)(n.code,{children:"Object"})," - Default loaders used internally by Next.js:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"babel"}),": ",(0,i.jsx)(n.code,{children:"Object"})," - Default ",(0,i.jsx)(n.code,{children:"babel-loader"})," configuration"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Example usage of ",(0,i.jsx)(n.code,{children:"defaultLoaders.babel"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// Example config for adding a loader that depends on babel-loader\n// This source was taken from the @next/mdx plugin source:\n// https://github.com/vercel/next.js/tree/canary/packages/next-mdx\nmodule.exports = {\n  webpack: (config, options) => {\n    config.module.rules.push({\n      test: /\\.mdx/,\n      use: [\n        options.defaultLoaders.babel,\n        {\n          loader: '@mdx-js/loader',\n          options: pluginOptions.options,\n        },\n      ],\n    })\n\n    return config\n  },\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"nextruntime",children:(0,i.jsx)(n.code,{children:"nextRuntime"})}),"\n",(0,i.jsxs)(n.p,{children:["Notice that ",(0,i.jsx)(n.code,{children:"isServer"})," is ",(0,i.jsx)(n.code,{children:"true"})," when ",(0,i.jsx)(n.code,{children:"nextRuntime"})," is ",(0,i.jsx)(n.code,{children:'"edge"'})," or ",(0,i.jsx)(n.code,{children:'"nodejs"'}),', nextRuntime "',(0,i.jsx)(n.code,{children:"edge"}),'" is currently for middleware and server components in edge runtime only.']}),"\n",(0,i.jsx)(n.h2,{id:"related",children:"Related"}),"\n",(0,i.jsx)("div",{class:"card",children:(0,i.jsxs)("a",{href:"/docs/api-reference/next.config.js/introduction.md",children:[(0,i.jsx)("b",{children:"Introduction to next.config.js:"}),(0,i.jsx)("small",{children:"Learn more about the configuration file used by Next.js."})]})})]})}function u(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>o,a:()=>r});var i=s(7294);const t={},c=i.createContext(t);function r(e){const n=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);