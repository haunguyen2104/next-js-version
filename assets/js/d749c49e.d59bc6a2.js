"use strict";(self.webpackChunknext_version=self.webpackChunknext_version||[]).push([[8327],{4796:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var s=t(5893),o=t(1151);const i={description:"Next.js supports built-in web font optimization to inline font CSS. Learn more here."},a="Font Optimization",r={id:"next-js/v13.0.0/basic-features/font-optimization",title:"Font Optimization",description:"Next.js supports built-in web font optimization to inline font CSS. Learn more here.",source:"@site/docs/next-js/v13.0.0/basic-features/font-optimization.md",sourceDirName:"next-js/v13.0.0/basic-features",slug:"/next-js/v13.0.0/basic-features/font-optimization",permalink:"/next-js/v13.0.0/basic-features/font-optimization",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/next-js/v13.0.0/basic-features/font-optimization.md",tags:[],version:"current",frontMatter:{description:"Next.js supports built-in web font optimization to inline font CSS. Learn more here."},sidebar:"tutorialSidebar",previous:{title:"Fast Refresh",permalink:"/next-js/v13.0.0/basic-features/fast-refresh"},next:{title:"Image Component and Image Optimization",permalink:"/next-js/v13.0.0/basic-features/image-optimization"}},l={},c=[{value:"Usage",id:"usage",level:2},{value:"Disabling Optimization",id:"disabling-optimization",level:2},{value:"Optimize CLS for Fonts",id:"optimize-cls-for-fonts",level:2},{value:"Related",id:"related",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,o.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"font-optimization",children:"Font Optimization"}),"\n",(0,s.jsxs)(n.p,{children:["Next.js helps you optimize loading web fonts by inlining font CSS during ",(0,s.jsx)(n.code,{children:"next build"}),". This optimization eliminates an extra network round trip to fetch font declaration files. This results in improvements to ",(0,s.jsx)(n.a,{href:"https://web.dev/fcp/",children:"First Contentful Paint (FCP)"})," and ",(0,s.jsx)(n.a,{href:"https://vercel.com/blog/core-web-vitals#largest-contentful-paint?utm_source=next-site&utm_medium=docs&utm_campaign=next-website",children:"Largest Contentful Paint (LCP)"}),". For example, this is the transformation Next.js makes:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'// Before\n<link\n  href="https://fonts.googleapis.com/css2?family=Inter&display=optional"\n  rel="stylesheet"\n/>\n\n// After\n<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />\n<style data-href="https://fonts.googleapis.com/css2?family=Inter&display=optional">\n  @font-face{font-family:\'Inter\';font-style:normal...\n</style>\n'})}),"\n",(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,s.jsxs)(n.p,{children:["To add a web font to your Next.js application, add the font to a ",(0,s.jsxs)(n.a,{href:"/docs/advanced-features/custom-document.md",children:["Custom ",(0,s.jsx)(n.code,{children:"Document"})]}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'// pages/_document.js\n\nimport { Html, Head, Main, NextScript } from \'next/document\'\n\nexport default function Document() {\n  return (\n    <Html>\n      <Head>\n        <link\n          href="https://fonts.googleapis.com/css2?family=Inter&display=optional"\n          rel="stylesheet"\n        />\n      </Head>\n      <body>\n        <Main />\n        <NextScript />\n      </body>\n    </Html>\n  )\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Adding fonts to ",(0,s.jsx)(n.code,{children:"_document"})," is preferred over individual pages. When adding fonts to a single page with ",(0,s.jsx)(n.a,{href:"/docs/api-reference/next/head.md",children:(0,s.jsx)(n.code,{children:"next/head"})}),", font optimizations included by Next.js will not work on navigations between pages client-side or when using ",(0,s.jsx)(n.a,{href:"/docs/advanced-features/react-18/streaming.md",children:"streaming"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Next.js currently supports optimizing Google Fonts and Typekit, with support for other font providers coming soon. We're also planning to add control over\xa0",(0,s.jsx)(n.a,{href:"https://github.com/vercel/next.js/issues/21555",children:"loading strategies"}),"\xa0and\xa0",(0,s.jsx)(n.code,{children:"font-display"}),"\xa0values. See ",(0,s.jsx)(n.a,{href:"https://nextjs.org/docs/messages/google-font-display",children:"Google Font Display"})," for more information."]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note"}),": Font Optimization does not currently support self-hosted fonts."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"disabling-optimization",children:"Disabling Optimization"}),"\n",(0,s.jsx)(n.p,{children:"If you do not want Next.js to optimize your fonts, you can opt-out."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// next.config.js\n\nmodule.exports = {\n  optimizeFonts: false,\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"optimize-cls-for-fonts",children:"Optimize CLS for Fonts"}),"\n",(0,s.jsxs)(n.p,{children:["Next.js can reduce the Cumulative Layout Shift (",(0,s.jsx)(n.a,{href:"https://web.dev/cls/",children:"CLS"}),") of your website by adjusting the size of your fallback fonts and inlining the font CSS."]}),"\n",(0,s.jsxs)(n.p,{children:["Sites that load fonts with ",(0,s.jsx)(n.code,{children:"font-display: swap"})," usually suffer from (",(0,s.jsx)(n.a,{href:"https://web.dev/cls/",children:"CLS"}),") when the web font loads and replaces the fallback font. This is due to differences in height, width, and alignment between the main and fallback fonts, which is common even if the CSS font size is the same."]}),"\n",(0,s.jsxs)(n.p,{children:["Next.js can reduce CLS automatically by adjusting the size of the fallback font to match that of the main font using font override metric properties such as ",(0,s.jsx)(n.code,{children:"size-adjust"}),", ",(0,s.jsx)(n.code,{children:"ascent-override"}),", ",(0,s.jsx)(n.code,{children:"descent-override"}),", and ",(0,s.jsx)(n.code,{children:"line-gap-override"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["To enable this experimental feature, update your ",(0,s.jsx)(n.code,{children:"next.config.js"})," with the following configuration:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"module.exports = {\n  experimental: {\n    adjustFontFallbacks: true,\n  },\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["When enabled, Next.js will generate a fallback font definition with the correct size overrides in the format ",(0,s.jsx)(n.code,{children:"{fontName} Fallback"}),".\nFor example, the font ",(0,s.jsx)(n.code,{children:"Inter"})," will generate the fallback font ",(0,s.jsx)(n.code,{children:"Inter Fallback"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"You can then use the fallback font in your stylesheets such as the following:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-css",children:"body {\n  font-family: 'Inter', 'Inter Fallback', sans-serif;\n}\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"NOTE"}),": Next.js currently supports one cross-platform serif font ('Times New Roman') and one cross-platform sans-serif font ('Arial')"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The final output will include the fallback override definition."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"// Injected into index.html during build/render\n<link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin />\n<style data-href=\"https://fonts.googleapis.com/css2?family=Inter&display=swap\">\n  @font-face{\n    font-family: 'Inter';\n    font-style:normal\n    ...\n  }\n\n  @font-face {\n    font-family: 'Inter Fallback',\n    src: local('Arial');\n    ascent-override: 96.975%;\n    ...\n  }\n</style>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"related",children:"Related"}),"\n",(0,s.jsx)(n.p,{children:"For more information on what to do next, we recommend the following sections:"}),"\n",(0,s.jsx)("div",{class:"card",children:(0,s.jsxs)("a",{href:"/docs/advanced-features/custom-document.md",children:[(0,s.jsx)("b",{children:"Custom Document"}),(0,s.jsx)("small",{children:"Learn how to augment your application's html and body tags."})]})})]})}function h(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>r,a:()=>a});var s=t(7294);const o={},i=s.createContext(o);function a(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);