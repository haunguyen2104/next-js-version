"use strict";(self.webpackChunknext_version=self.webpackChunknext_version||[]).push([[9694],{6186:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>a});var o=n(5893),t=n(1151);const i={description:"Extend the PostCSS config and plugins added by Next.js with your own."},r="Customizing PostCSS Config",l={id:"next-js/v13.0.1/advanced-features/customizing-postcss-config",title:"Customizing PostCSS Config",description:"Extend the PostCSS config and plugins added by Next.js with your own.",source:"@site/docs/next-js/v13.0.1/advanced-features/customizing-postcss-config.md",sourceDirName:"next-js/v13.0.1/advanced-features",slug:"/next-js/v13.0.1/advanced-features/customizing-postcss-config",permalink:"/next-js/v13.0.1/advanced-features/customizing-postcss-config",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/next-js/v13.0.1/advanced-features/customizing-postcss-config.md",tags:[],version:"current",frontMatter:{description:"Extend the PostCSS config and plugins added by Next.js with your own."},sidebar:"tutorialSidebar",previous:{title:"Customizing Babel Config",permalink:"/next-js/v13.0.1/advanced-features/customizing-babel-config"},next:{title:"Debugging",permalink:"/next-js/v13.0.1/advanced-features/debugging"}},c={},a=[{value:"Default Behavior",id:"default-behavior",level:2},{value:"Customizing Target Browsers",id:"customizing-target-browsers",level:2},{value:"CSS Modules",id:"css-modules",level:2},{value:"Customizing Plugins",id:"customizing-plugins",level:2}];function d(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components},{Details:n}=s;return n||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.h1,{id:"customizing-postcss-config",children:"Customizing PostCSS Config"}),"\n",(0,o.jsxs)(n,{open:!0,children:[(0,o.jsx)("summary",{children:(0,o.jsx)("b",{children:"Examples"})}),(0,o.jsx)("ul",{children:(0,o.jsx)("li",{children:(0,o.jsx)("a",{href:"https://github.com/vercel/next.js/tree/canary/examples/with-tailwindcss",children:"Tailwind CSS Example"})})})]}),"\n",(0,o.jsx)(s.h2,{id:"default-behavior",children:"Default Behavior"}),"\n",(0,o.jsxs)(s.p,{children:["Next.js compiles CSS for its ",(0,o.jsx)(s.a,{href:"/docs/basic-features/built-in-css-support.md",children:"built-in CSS support"})," using PostCSS."]}),"\n",(0,o.jsx)(s.p,{children:"Out of the box, with no configuration, Next.js compiles CSS with the following transformations:"}),"\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.a,{href:"https://github.com/postcss/autoprefixer",children:"Autoprefixer"})," automatically adds vendor prefixes to CSS rules (back to IE11)."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.a,{href:"https://github.com/philipwalton/flexbugs",children:"Cross-browser Flexbox bugs"})," are corrected to behave like ",(0,o.jsx)(s.a,{href:"https://www.w3.org/TR/css-flexbox-1/",children:"the spec"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["New CSS features are automatically compiled for Internet Explorer 11 compatibility:","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:(0,o.jsxs)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/all",children:[(0,o.jsx)(s.code,{children:"all"})," Property"]})}),"\n",(0,o.jsx)(s.li,{children:(0,o.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/break-after",children:"Break Properties"})}),"\n",(0,o.jsx)(s.li,{children:(0,o.jsxs)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/font-variant",children:[(0,o.jsx)(s.code,{children:"font-variant"})," Property"]})}),"\n",(0,o.jsx)(s.li,{children:(0,o.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/gap",children:"Gap Properties"})}),"\n",(0,o.jsx)(s.li,{children:(0,o.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/Media_Queries/Using_media_queries#Syntax_improvements_in_Level_4",children:"Media Query Ranges"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.p,{children:["By default, ",(0,o.jsx)(s.a,{href:"https://www.w3.org/TR/css-grid-1/",children:"CSS Grid"})," and ",(0,o.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/var",children:"Custom Properties"})," (CSS variables) are ",(0,o.jsx)(s.strong,{children:"not compiled"})," for IE11 support."]}),"\n",(0,o.jsxs)(s.p,{children:["To compile ",(0,o.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/grid",children:"CSS Grid Layout"})," for IE11, you can place the following comment at the top of your CSS file:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-css",children:"/* autoprefixer grid: autoplace */\n"})}),"\n",(0,o.jsxs)(s.p,{children:["You can also enable IE11 support for ",(0,o.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/grid",children:"CSS Grid Layout"}),"\nin your entire project by configuring autoprefixer with the configuration shown below (collapsed).\nSee ",(0,o.jsx)(s.a,{href:"#customizing-plugins",children:'"Customizing Plugins"'})," below for more information."]}),"\n",(0,o.jsxs)(n,{children:[(0,o.jsx)("summary",{children:(0,o.jsx)("strong",{children:"Click to view the configuration to enable CSS Grid Layout"})}),(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-json",children:'{\n  "plugins": [\n    "postcss-flexbugs-fixes",\n    [\n      "postcss-preset-env",\n      {\n        "autoprefixer": {\n          "flexbox": "no-2009",\n          "grid": "autoplace"\n        },\n        "stage": 3,\n        "features": {\n          "custom-properties": false\n        }\n      }\n    ]\n  ]\n}\n'})})]}),"\n",(0,o.jsx)("br",{}),"\n",(0,o.jsxs)(s.p,{children:["CSS variables are not compiled because it is ",(0,o.jsx)(s.a,{href:"https://github.com/MadLittleMods/postcss-css-variables#caveats",children:"not possible to safely do so"}),".\nIf you must use variables, consider using something like ",(0,o.jsx)(s.a,{href:"https://sass-lang.com/documentation/variables",children:"Sass variables"})," which are compiled away by ",(0,o.jsx)(s.a,{href:"https://sass-lang.com/",children:"Sass"}),"."]}),"\n",(0,o.jsx)(s.h2,{id:"customizing-target-browsers",children:"Customizing Target Browsers"}),"\n",(0,o.jsxs)(s.p,{children:["Next.js allows you to configure the target browsers (for ",(0,o.jsx)(s.a,{href:"https://github.com/postcss/autoprefixer",children:"Autoprefixer"})," and compiled css features) through ",(0,o.jsx)(s.a,{href:"https://github.com/browserslist/browserslist",children:"Browserslist"}),"."]}),"\n",(0,o.jsxs)(s.p,{children:["To customize browserslist, create a ",(0,o.jsx)(s.code,{children:"browserslist"})," key in your ",(0,o.jsx)(s.code,{children:"package.json"})," like so:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-json",children:'{\n  "browserslist": [">0.3%", "not ie 11", "not dead", "not op_mini all"]\n}\n'})}),"\n",(0,o.jsxs)(s.p,{children:["You can use the ",(0,o.jsx)(s.a,{href:"https://browserl.ist/?q=%3E0.3%25%2C+not+ie+11%2C+not+dead%2C+not+op_mini+all",children:"browserl.ist"})," tool to visualize what browsers you are targeting."]}),"\n",(0,o.jsx)(s.h2,{id:"css-modules",children:"CSS Modules"}),"\n",(0,o.jsxs)(s.p,{children:["No configuration is needed to support CSS Modules. To enable CSS Modules for a file, rename the file to have the extension ",(0,o.jsx)(s.code,{children:".module.css"}),"."]}),"\n",(0,o.jsxs)(s.p,{children:["You can learn more about ",(0,o.jsx)(s.a,{href:"/docs/basic-features/built-in-css-support.md",children:"Next.js' CSS Module support here"}),"."]}),"\n",(0,o.jsx)(s.h2,{id:"customizing-plugins",children:"Customizing Plugins"}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Warning"}),": When you define a custom PostCSS configuration file, Next.js ",(0,o.jsx)(s.strong,{children:"completely disables"})," the ",(0,o.jsx)(s.a,{href:"#default-behavior",children:"default behavior"}),".\nBe sure to manually configure all the features you need compiled, including ",(0,o.jsx)(s.a,{href:"https://github.com/postcss/autoprefixer",children:"Autoprefixer"}),".\nYou also need to install any plugins included in your custom configuration manually, i.e. ",(0,o.jsx)(s.code,{children:"npm install postcss-flexbugs-fixes postcss-preset-env"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(s.p,{children:["To customize the PostCSS configuration, create a ",(0,o.jsx)(s.code,{children:"postcss.config.json"})," file in the root of your project."]}),"\n",(0,o.jsx)(s.p,{children:"This is the default configuration used by Next.js:"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-json",children:'{\n  "plugins": [\n    "postcss-flexbugs-fixes",\n    [\n      "postcss-preset-env",\n      {\n        "autoprefixer": {\n          "flexbox": "no-2009"\n        },\n        "stage": 3,\n        "features": {\n          "custom-properties": false\n        }\n      }\n    ]\n  ]\n}\n'})}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Note"}),": Next.js also allows the file to be named ",(0,o.jsx)(s.code,{children:".postcssrc.json"}),", or, to be read from the ",(0,o.jsx)(s.code,{children:"postcss"})," key in ",(0,o.jsx)(s.code,{children:"package.json"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(s.p,{children:["It is also possible to configure PostCSS with a ",(0,o.jsx)(s.code,{children:"postcss.config.js"})," file, which is useful when you want to conditionally include plugins based on environment:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-js",children:"module.exports = {\n  plugins:\n    process.env.NODE_ENV === 'production'\n      ? [\n          'postcss-flexbugs-fixes',\n          [\n            'postcss-preset-env',\n            {\n              autoprefixer: {\n                flexbox: 'no-2009',\n              },\n              stage: 3,\n              features: {\n                'custom-properties': false,\n              },\n            },\n          ],\n        ]\n      : [\n          // No transformations in development\n        ],\n}\n"})}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Note"}),": Next.js also allows the file to be named ",(0,o.jsx)(s.code,{children:".postcssrc.js"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(s.p,{children:["Do ",(0,o.jsxs)(s.strong,{children:["not use ",(0,o.jsx)(s.code,{children:"require()"})]})," to import the PostCSS Plugins. Plugins must be provided as strings."]}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Note"}),": If your ",(0,o.jsx)(s.code,{children:"postcss.config.js"})," needs to support other non-Next.js tools in the same project, you must use the interoperable object-based format instead:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-js",children:"module.exports = {\n  plugins: {\n    'postcss-flexbugs-fixes': {},\n    'postcss-preset-env': {\n      autoprefixer: {\n        flexbox: 'no-2009',\n      },\n      stage: 3,\n      features: {\n        'custom-properties': false,\n      },\n    },\n  },\n}\n"})}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,t.a)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},1151:(e,s,n)=>{n.d(s,{Z:()=>l,a:()=>r});var o=n(7294);const t={},i=o.createContext(t);function r(e){const s=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),o.createElement(i.Provider,{value:s},e.children)}}}]);